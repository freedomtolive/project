<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="dialog.css" />
	</head>
	<body>
		<div id="dialog_wrap">
			<header id="dialog_head">
				<div class="dialog_head_left">
					<div class="dialog_head_img"></div>
					<span class="gang">|</span>
					<h3 class="dialog_title">此电脑</h3>
				</div>
				<div class="dialog_head_right">
					<div>
						<span class="min"></span>
					</div>
					<div>
						<span class="max"></span>
					</div>
					<div>
						<span class="close"></span>
					</div>
				</div>
			</header>
			<div id="dialog_div">
				<div class="dialog_div_left">
					<div>文件</div>
					<div>计算机</div>
					<div>查看</div>
				</div>
				<div class="dialog_div_right">
					<div>
						<span></span>
					</div>
					<div>
						<span></span>
					</div>
				</div>
			</div>
			<nav id="dialog_nav">
				<div class="dialog_nav_left">
					<span></span>
					<span></span>
					<span></span>
					<span>
						<i></i>
					</span>
				</div>
				<div class="dialog_nav_center">
					<span class="dialog_center_img"></span>
					<div class="dialog_center_font">
						<span class="jiantou"></span>
						<div class="dialog_nav_font">此电脑</div>
						<input type="text" class="dialog_nav_input"  />
					</div>
					<div class="dialog_resize">
						<span></span>
					</div>
					<div class="dialog_selected">
						<span></span>
					</div>
				</div>
				<div class="dialog_nav_right">
					<input type="text" class="dialog_nav_fond" placeholder="搜索此电脑"  />
					<div class="dialog_sousuo"></div>
				</div>
			</nav>
			<div id="dialog_content">
				<div class="dialog_content_left">
					<ul class="tree">
						<li class="sort">
							<h3>
								<span class="tubiao"></span>
								快速访问
							</h3>
							<ul>
								<li>
									<h3>
										<span class="dialog_tabloe"></span>
										桌面
									</h3>
								</li>
								<li>
									<h3>
										<span class="dialog_down"></span>
										下载
									</h3>
								</li>
								<li>
									<h3>
										<span class="dialog_docu"></span>
										文档
									</h3>
								</li>
								<li>
									<h3>
										<span class="dialog_peacture"></span>
										图片
									</h3>
								</li>
								<li>
									<h3>
										<span class="dialog_homework"></span>
										2016-06-08作业
									</h3>
								</li>
								<li>
									<h3>
										<span class="dialog_mydown"></span>
										我的下载
									</h3>
								</li>
							</ul>
						</li>
						<li>
							<h3>
								<span class="dialog_onedriver"></span>
								OneDriver
							</h3>
						</li>
						<li class="dialog_conmput">
							<h3>
								<span class="dialog_mycomputer"></span>
								此电脑
							</h3>
							<!--<ul class="dialog_computed">-->
								<!--<li class="dialog_comput">
									<h3>
										<span class="dialog_mycomputer"></span>
										此电脑
									</h3>
								</li>-->
							<!--</ul>-->
						</li>
						<li>
							<h3>
								<span class="dialog_web"></span>
								网络
							</h3>
						</li>
					</ul>
				</div>
				<div class="dialog_scroll_wrap">
					<div class="scroll_inner"></div>
				</div>
				<!--<div id="dialog_content_right_wrap">-->
					<div class="dialog_content_right">
						<div class="dialog_right">
							<header class="dialog_sort_contentHead">
								<span></span>
								<h3 class="file_title">文件夹</h3>
								<div class="line"></div>
							</header>
							<ul class="dialog_sort_contentTop clearfix">
								<!--<li>
									<h3>
										<span class="dialog_shipin"></span>
										视频
									</h3>
								</li>-->
							</ul>
							<div class="dialog_sort_contentBottom">
								<span></span>
								<h3 class="file_title">设备和驱动器</h3>
								<div class="line2"></div>
							</div>
							<ul class="dialog_sort_contentBottom2 clearfix">
								<!--<li>
									<span class="dialog_C"></span>
									<div class="contentBottom2_right">
										<div>本地磁盘(C;)</div>
										<div>
											<div class="jindu"></div>
										</div>
										<div>
											<span>90.5</span>GB可用，共<span>118</span>GB
										</div>
									</div>
								</li>-->
							</ul>
						</div>
					</div>
					<div class="dialog_scroll_wrap2">
						<div class="scroll_inner2"></div>
					</div>
				<!--</div>-->
			</div>
		</div>
	</body>
	<script src="../js/data.js"></script>
	<script src="../js/tools.js"></script>
	<script src="../js/html.js"></script>
	<script src="../js/jquery-3.1.1.js"></script>
	<script>
		var oDialog = document.getElementsByClassName("dialog_conmput")[0];
		oDialog.innerHTML += html.createMyComputedHtml(data.myComputed,0);
		
		var oDialog_sort = document.getElementsByClassName("dialog_sort_contentTop")[0];
		oDialog_sort.innerHTML=html.createSortHtml(data.myComputed);
		
		var oDialog_sort2 = document.getElementsByClassName("dialog_sort_contentBottom2")[0];
		oDialog_sort2.innerHTML=html.createComputHtml(data.myComputed);
		
//---------------------------自定义滚动条-------------------------------------
		var scroll_wrap = $(".dialog_scroll_wrap");
		var scroll_inner = $(".scroll_inner");
		var box = $(".dialog_content_left");
		var inner = $(".tree");
		
		//计算滚动条的高度
		//如果内容高度小于ul的高度，隐藏滚动条
		if($(dialog_content).innerHeight()>= inner.innerHeight()){
			scroll_inner.hide()
		}else{
			scroll_inner.show()
		}
//		scroll_inner[0].style.height = $(dialog_content).innerHeight()/ inner.innerHeight() * scroll_wrap.innerHeight() + 'px';
		var innerMaxTop = inner.innerHeight()- $(dialog_content).innerHeight();
		var maxTop = scroll_wrap[0].clientHeight - scroll_inner[0].offsetHeight //可滚动的最大top值
		var y = 0;
		
		
		scroll_inner.mousedown(function(ev){
			ev.preventDefault();
			var disY = ev.pageY - scroll_inner[0].offsetTop;
			$(window).mousemove(function(e){
				y = e.clientY - disY;
				y = y<0?0:y;
				y = y>maxTop?maxTop:y;
//					计算当前top值占总可移动距离的top的百分比
				var s = y/maxTop;
				
				inner[0].style.top = -s * innerMaxTop +"px";
				scroll_inner[0].style.top = y + "px";
				
			})
			$(window).mouseup(function(e){
				$(window).off("mousemove");
				$(window).off("mouseup")
			})
		})
		addScroll (scroll_wrap[0],goUp,goDown)
		addScroll (inner[0],goUp,goDown)
		
		
		function goUp(){//滚动条向上走，页面主体内容往下移动
//				限制y
			y-=50;
			y = y<0?0:y;
//				计算比例
			var s = y/maxTop;
			inner[0].style.top = -s * innerMaxTop +"px";
			scroll_inner[0].style.top = y + "px";
		}
		function goDown(){//滚动条向下走，页面主体内容往上移动
			y+=50;
			y = y>maxTop?maxTop:y;
			var s = y/maxTop;
			inner[0].style.top = -s * innerMaxTop +"px";
			scroll_inner[0].style.top = y + "px";
		}
		
		function addScroll (obj,fnUp,fnDown) {
			//为obj添加鼠标滚轮事件处理函数
			obj.onmousewheel = fn;
			obj.addEventListener("DOMMouseScroll",fn);
			
			function fn(e) {//只要滚动滚轮了，就会触发fn
				if(e.wheelDelta){//chrome
					e.wheelDelta<0? fnDown(): fnUp();
					return false;//阻止默认行为，防止页面滚动
				}
				if(e.detail){//firefox
					e.detail>0? fnDown(): fnUp();
					e.preventDefault();
				}
			}
		}
		
		
		//-----------------自定义滚动条2-----------------------------
		
		var scroll_wrap2 = $(".dialog_scroll_wrap2");
		var scroll_inner2 = $(".scroll_inner2");
		var box2 = $(".dialog_content_right");
		var inner2 = $(".dialog_right");
		var y2 = 0;
		
		var inner2MaxTop = inner2.innerHeight()- box2.innerHeight();
		var maxTop2 = scroll_wrap2[0].clientHeight - scroll_inner2[0].offsetHeight //可滚动的最大top值
		
		if(box2.innerHeight()>= inner2.innerHeight()){
			scroll_inner2.hide()
		}else{
			scroll_inner2.show()
		}
		
		scroll_inner2.mousedown(function(ev){
			ev.preventDefault();
			var disY = ev.pageY - scroll_inner2[0].offsetTop;
			$(window).mousemove(function(e){
				y2 = e.pageY - disY;
				y2 = y2<0?0:y2;
				y2 = y2>maxTop2?maxTop2:y2;
//					计算当前top值占总可移动距离的top的百分比
				var s = y2/maxTop;
				
				inner2[0].style.top = -s * inner2MaxTop +"px";
				scroll_inner2[0].style.top = y2 + "px";
				
			})
			$(window).mouseup(function(e){
				$(window).off("mousemove");
				$(window).off("mouseup")
			})
		})
		addScroll(scroll_wrap2[0],goUp2,goDown2)
		addScroll(inner2[0],goUp2,goDown2)
		console.log(inner2[0])
		
		function goUp2(){//滚动条向上走，页面主体内容往下移动
//				限制y
			y2-=50;
			y2 = y2<0?0:y2;
//				计算比例
			var s = y2/maxTop2;
			inner2[0].style.top = -s * inner2MaxTop+"px";
			scroll_inner2[0].style.top = y2 + "px";
		}
		function goDown2(){//滚动条向下走，页面主体内容往上移动
			y2+=50;
			y2 = y2>maxTop2?maxTop2:y2;
			var s = y2/maxTop2;
			inner2[0].style.top = -s * inner2MaxTop +"px";
			scroll_inner2[0].style.top = y2 + "px";
		}
		
		
		
		
	</script>
</html>
